<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width" />
  <title>ChimpSnap个人主页</title>
  <link rel="icon" href="https://i3.imgs.ovh/d/BQACAgEAAx0EUvSR8wACKqpmwqz4NzqZEHSxOH-7aY9i2oZxMwACyQQAAvSUGUaSGE1HYKAayTUE" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css" />
  <link rel="stylesheet" href="mobile.css" />
  <link rel="stylesheet" href="logout2.css" />
  <link rel="stylesheet" href="loading.css" />
  <script src="get.js" defer></script>
  <script src="changename.js" defer></script>
</head>
<body>


  <div class="container2">
    <header>
      <div class="profile">
        <div class="profile-image">
            <button id="changeImageBtn" class="btn" style="border: 0.5px solid #fff;margin-left: 5px;">
          <img id="profileImage" src="http://pictures.chimpsnap.fun/Mr.Chimp.png" alt="" width="250" height="250" style="width:100%" /></button>
          
          <!-- 隐藏的文件输入框 -->
          <input type="file" id="fileInput" style="display:none;">
        </div>
        <div class="profile-user-settings">
          <h1 id="profile-user-name" class="profile-user-name">Mr.Chimp🕶</h1>
          <button class="btn profile-edit-btn" aria-label="profile settings">
            <i class="fas fa-cog" aria-hidden="true"></i>
          </button>
          <!--logout按钮-->
          
          
          
    

<script>
    document.addEventListener("DOMContentLoaded", function() {
    const logoutButton = document.querySelector(".Btn");
    
    logoutButton.addEventListener("click", function() {
        // Clear all local storage
        localStorage.clear();

        // Optionally, you can specifically remove the token if you don't want to clear everything
        // localStorage.removeItem("token");

        // Redirect to login page or refresh the current page
        window.location.href = "http://www.chimpsnap.fun"; // Update the URL to your login page
    });
});

</script>
          
          
           <!--logout按钮-->
        </div>
        <div class="profile-stats">
          <ul>
            <li><span class="profile-stat-count" id = "posts">0</span> posts</li>
            <li><span class="profile-stat-count" id = "likes">0</span> likes</li>
            <li><span class="profile-stat-count" id = "followers">0</span> followers</li>
          </ul>
        </div>
        <div class="profile-bio">
        <p>
          <span id="profile-real-name" class="profile-real-name">| 你好 | Hello | こんにちは | Bonjour | Hallo | नमस्ते | Hola | 안녕하세요 | བདེ་མོ |📷✈️🏕️</span>
        </p>
        
        <p id="profile-gender" class="profile-gender" style="margin-top:20px">性别：男</p>
      </div>
      <div class="edit-form" style="display: none;">
        <input type="text" id="edit-user-name" placeholder="给自己取个名字吧！" />
        <input type="text" id="edit-real-name" placeholder="编辑个性签名" />
        <select id="edit-gender">
          <option value="男">男</option>
          <option value="女">女</option>
          <option value="未知">未知</option>
        </select>
        <button id="save-button">保存</button>
      </div>
      </div>
    </header>
  </div>

<script>
  document.querySelector('.profile-edit-btn').addEventListener('click', function() {
    document.querySelector('.edit-form').style.display = 'block';
    document.getElementById('edit-user-name').value = document.getElementById('profile-user-name').innerText;
    document.getElementById('edit-real-name').value = document.getElementById('profile-real-name').innerText;

    // 设置编辑性别表单的值
    const genderText = document.getElementById('profile-gender').innerText.replace('性别：', '');
    document.getElementById('edit-gender').value = genderText;
  });

  document.getElementById('save-button').addEventListener('click', function() {
    document.getElementById('profile-user-name').innerText = document.getElementById('edit-user-name').value;
    document.getElementById('profile-real-name').innerText = document.getElementById('edit-real-name').value;

    // 保存并更新性别
    const selectedGender = document.getElementById('edit-gender').value;
    document.getElementById('profile-gender').innerText = '性别：' + selectedGender;

    document.querySelector('.edit-form').style.display = 'none';
  });

/*
  document.getElementById('changeImageBtn').addEventListener('click', function() {
    document.getElementById('fileInput').click();
  });

  document.getElementById('fileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('profileImage').src = e.target.result;
      };
      reader.readAsDataURL(file);
    }
  });*/
</script>

   <main>
    <div class="container">
      <div class="gallery" id="gallery">
        <!-- Gallery items will be generated here -->
      </div>
     
     
<div aria-label="Orange and tan hamster running in a metal wheel" role="img" class="wheel-and-hamster">
	<div class="wheel"></div>
	<div class="hamster">
		<div class="hamster__body">
			<div class="hamster__head">
				<div class="hamster__ear"></div>
				<div class="hamster__eye"></div>
				<div class="hamster__nose"></div>
			</div>
			<div class="hamster__limb hamster__limb--fr"></div>
			<div class="hamster__limb hamster__limb--fl"></div>
			<div class="hamster__limb hamster__limb--br"></div>
			<div class="hamster__limb hamster__limb--bl"></div>
			<div class="hamster__tail"></div>
		</div>
	</div>
	<div class="spoke"></div>
</div>
     
     
     
    </div>
  </main>

  <script>
// Function to create a gallery item
// Function to create a gallery item
function createGalleryItem(data) {
  const item = document.createElement('div');
  item.classList.add('gallery-item');
  item.tabIndex = 0; // Adding tabindex to make it focusable

  // Create image element
  const image = document.createElement('img');
  image.src = data.coverImg;
  image.alt = data.title || '';
  image.classList.add('gallery-image');

  // Create gallery item info
  const info = document.createElement('div');
  info.classList.add('gallery-item-info');

  const ul = document.createElement('ul');

  // Likes
  const likesLi = document.createElement('li');
  likesLi.classList.add('gallery-item-likes');
  likesLi.innerHTML = `
    <span class="visually-hidden">Likes:</span>
    <i class="fas fa-heart" aria-hidden="true"></i> ${data.likes || 0}
  `;

  // Comments
  const commentsLi = document.createElement('li');
  commentsLi.classList.add('gallery-item-comments');
  commentsLi.innerHTML = `
    <span class="visually-hidden">Comments:</span>
    <i class="fas fa-comment" aria-hidden="true"></i> ${data.comments || 0}
  `;

  // Append likes and comments to ul
  ul.appendChild(likesLi);
  ul.appendChild(commentsLi);

  // Append ul to info
  info.appendChild(ul);

  // Append image and info to item
  item.appendChild(image);
  item.appendChild(info);

  
  item.addEventListener('click', () => {
    // Store data.id in localStorage with key 'currentPostId'
    localStorage.setItem('currentPostId', data.id);

    // Navigate to the post page
    window.location.href = 'http://www.chimpsnap.fun/post/post.html';
  });
  
  return item;
}


// Function to load gallery data from the server
async function loadGallery() {
  try {
    const token = localStorage.getItem('token');
    const response = await fetch('http://103.117.121.141:8080/posts/postsInfo', {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
  
    if (response.ok) {
      const responseData = await response.json();
      const galleryData = responseData.data; // Access the .data field
        console.log(responseData);
      if (Array.isArray(galleryData)) { // Ensure galleryData is an array
        const galleryContainer = document.getElementById('gallery');
        
        // Clear existing gallery items if any
        galleryContainer.innerHTML = '';

        galleryData.forEach(data => {
          const galleryItem = createGalleryItem(data);
          galleryContainer.appendChild(galleryItem);
        });
      } else {
        console.error('Expected an array for gallery data but got:', galleryData);
      }
    } else {
      console.error('Failed to fetch gallery data:', response.statusText);
    }
  } catch (error) {
    console.error('Error fetching gallery data:', error);
  }
}



// Load gallery on page load
document.addEventListener('DOMContentLoaded', loadGallery);


  </script>
  
  
  <script src="changehead.js"></script>
</body>
</html>
